#! /bin/bash
# Export the database dump generated by this Ohana server directly into
# your Heroku instance, overwriting any existing data.
#
# Are you sure you want to do this?
#
# You'll need to customize this using the db connection information
# available at:
# https://postgres.heroku.com/databases/{YOUR_APP_NAME}-heroku-postgresql-red
#
# Or by clicking "Heroku Postgres :: Red" on:
# https://dashboard.heroku.com/apps/{YOUR_APP_NAME}/resources
#
# -h: Host
# -U: User
# -d: Database
# -c: Drop the database before running. This is the dangerous part.
# --no-owner: Don't change object ownership in case your local users don't match prod.
#
# You'll be prompted to enter your Password.

# Dump dev to prod.dump
./script/export_prod_db

# Restore prod.dump in Heroku
pg_restore -hec2-107-21-118-56.compute-1.amazonaws.com -Uvljuywjvqfnoqe -c --no-owner -dd89j2n40edj66 data/ohana_api_production.dump
